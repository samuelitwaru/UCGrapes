(()=>{"use strict";class e{constructor(){this._themes=[],this._services=[],this._forms=[],this._media=[],this._currentThemeId=null,this._isInitialized=!1}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(e,t,i,n,s){this._isInitialized?console.warn("AppConfig already initialized - ignoring new data"):(this._themes=e,this._services=t,this._forms=i,this._media=n,this._currentThemeId=s,this._isInitialized=!0)}get themes(){return this._themes}get services(){return this._services}get forms(){return this._forms}get media(){return this._media}get currentThemeId(){return this._currentThemeId}set currentThemeId(e){this._currentThemeId=e}get isInitialized(){return this._isInitialized}}e.instance=null;class t{constructor(e,t,i={}){this.button=document.createElement("button"),this.button.id=e,this.button.className=`tb-btn tb-btn-${i.variant||"primary"}`,i.svg&&this.button.appendChild(i.svg);const n=document.createElement("span");i.labelId&&(n.id=i.labelId),n.textContent=t,this.button.appendChild(n)}render(e){e.appendChild(this.button)}}class i{constructor(){this.container=document.createElement("div"),this.undoButton=document.createElement("button"),this.redoButton=document.createElement("button"),this.init()}init(){this.container.classList.add("edit-actions"),this.undoButton.id="undo",this.undoButton.className="btn-transparent",this.undoButton.title="Undo (ctrl+z)",this.undoButton.innerHTML="<span class='fa fa-undo'></span>",this.undoButton.addEventListener("click",this.handleUndo),this.redoButton.id="redo",this.redoButton.className="btn-transparent",this.redoButton.title="Redo (ctrl+shift+z)",this.redoButton.innerHTML="<span class='fa fa-redo'></span>",this.redoButton.addEventListener("click",this.handleRedo),this.container.appendChild(this.undoButton),this.container.appendChild(this.redoButton)}handleUndo(){console.log("Undo action triggered")}handleRedo(){console.log("Redo action triggered")}render(e){e.appendChild(this.container)}}class n{constructor(e,t){this.containerId=t,this.paletteContainer=document.createElement("div"),this.paletteContainer.className="color-palette",this.paletteContainer.id=t,Object.entries(e).forEach((([e,t])=>{const i=document.createElement("div");i.className="color-item";const n=document.createElement("input");n.type="radio",n.id=`color-${e}`,n.name="theme-color",n.value=t;const s=document.createElement("label");s.htmlFor=`color-${e}`,s.className="color-box",s.setAttribute("data-tile-bgcolor",t),s.style.backgroundColor=t,i.appendChild(n),i.appendChild(s),this.paletteContainer.appendChild(i)}))}render(e){e.appendChild(this.paletteContainer)}refresh(e){const t=document.getElementById(this.containerId);t?(t.replaceWith(this.paletteContainer),console.log(`Replaced existing color palette with ID: ${this.containerId}`)):e.appendChild(this.paletteContainer)}}class s{constructor(e,t){this.icons=[],this.iconsCategory="General",this.themeManager=e,this.iconsCategory=t,this.init()}init(){this.icons=[],console.log("IconList init");const e=this.themeManager.getActiveThemeIcons();this.themeManager.getActiveTheme(),e.filter((e=>e.IconCategory===this.iconsCategory)).forEach((e=>{const t=document.createElement("div");t.classList.add("icon"),t.title=e.IconName,t.innerHTML=`${e.IconSVG}`,this.icons.push(t)})),console.log("icons count: ",this.icons.length)}render(e){this.icons.forEach((t=>e.appendChild(t)))}}class o{constructor(){this.themes=[],this.config=e.getInstance(),this.setThemes(this.config.themes)}setThemes(e){this.themes=e}getThemes(){return this.themes}getActiveTheme(){return this.getThemes().find((e=>e.ThemeId===this.config.currentThemeId))}getActiveThemeIcons(){const e=this.getActiveTheme();return e?e.ThemeIcons:[]}getActiveThemeColors(){const e=this.getActiveTheme();return e?e.ThemeColors:{}}setTheme(e){this.config.currentThemeId=e.ThemeId,this.updateColorPallete(e.ThemeColors),this.updateThemeIcons()}updateColorPallete(e){const t=new n(e,"theme-color-palette"),i=document.querySelector(".sidebar-section .theme-section");t.refresh(i)}updateThemeIcons(){const e=document.getElementById("icons-list");e.classList.add("icons-list"),e.id="icons-list",e.innerHTML="",new s(this,"General").render(e)}}class a{constructor(e,t=300){this.preloaderElement=e,this.minDuration=t,this._loading=!1,this._startTime=0,this.transitionDuration=200}get loading(){return this._loading}set loading(e){this._loading=e,e?(this._startTime=performance.now(),this.showPreloader()):this.hidePreloader()}showPreloader(){this.preloaderElement.style.display="flex",requestAnimationFrame((()=>{this.preloaderElement.style.transform=`opacity ${this.transitionDuration}ms ease-in-out 0s`,this.preloaderElement.style.opacity="1"}))}hidePreloader(){const e=performance.now()-this._startTime;e>=this.minDuration?(this.preloaderElement.style.transition=`opacity ${this.transitionDuration}ms ease-in-out`,this.preloaderElement.style.opacity="0",setTimeout((()=>{this.preloaderElement.style.display="none"}),this.transitionDuration)):setTimeout((()=>{this.hidePreloader()}),this.minDuration-e)}}var r=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function r(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};const c=window.location.origin+(window.location.origin.startsWith("http://localhost")?"/ComfortaKBDevelopmentNETSQLServer":"");class d{constructor(){this.services=[],this.forms=[],this.media=[],this.pages=[],this.preloaderEl=document.getElementById("preloader"),this.config=e.getInstance(),this.init()}init(){this.services=this.config.services,this.forms=this.config.forms,this.media=this.config.media,this.pages=[],this.loadingManager=new a(this.preloaderEl)}fetchAPI(e){return r(this,arguments,void 0,(function*(e,t={},i=!1){const n={headers:{"Content-Type":"application/json"}};try{i||(this.loadingManager.loading=!0);const s=yield fetch(`${c}${e}`,Object.assign(Object.assign({},n),t));if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return yield s.json()}catch(t){throw console.error(`API Error (${e}):`,t),t}finally{i||(this.loadingManager.loading=!1)}}))}getPages(){return r(this,void 0,void 0,(function*(){return this.pages=yield this.fetchAPI("/api/toolbox/pages/list",{},!0),this.pages}))}getServices(){return r(this,void 0,void 0,(function*(){const e=yield this.fetchAPI("/api/toolbox/services",{},!0);return this.services=e.SDT_ProductServiceCollection,this.services}))}getSinglePage(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/toolbox/singlepage?Pageid=${e}`)}))}deletePage(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/toolbox/deletepage?Pageid=${e}`)}))}getPagesService(){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/pages/tree")}))}createNewPage(e,t){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/create-page",{method:"POST",body:JSON.stringify({PageName:e,PageJsonContent:JSON.stringify({})})})}))}updatePage(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/update-page",{method:"POST",body:JSON.stringify(e)},!0)}))}updatePagesBatch(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/update-pages-batch",{method:"POST",body:JSON.stringify(e)})}))}addPageChild(e,t){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/add-page-children",{method:"POST",body:JSON.stringify({ParentPageId:t,ChildPageId:e})})}))}createContentPage(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/create-content-page",{method:"POST",body:JSON.stringify({PageId:e})})}))}createDynamicFormPage(e,t){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/create-dynamic-form-page",{method:"POST",body:JSON.stringify({FormId:e,PageName:t})})}))}getLocationTheme(){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/location-theme")}))}updateLocationTheme(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/update-location-theme",{method:"POST",body:JSON.stringify({ThemeId:e})})}))}getMediaFiles(){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/media/")}))}deleteMedia(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/media/delete?MediaId=${e}`)}))}uploadFile(e,t,i,n){return r(this,void 0,void 0,(function*(){if(!e)throw new Error("Please select a file!");return yield this.fetchAPI("/api/media/upload",{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:JSON.stringify({MediaName:t,MediaImageData:e,MediaSize:i,MediaType:n})},!0)}))}uploadLogo(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/media/upload/logo",{method:"POST",body:JSON.stringify({LogoUrl:e})})}))}uploadProfileImage(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/media/upload/profile",{method:"POST",body:JSON.stringify({ProfileImageUrl:e})})}))}getContentPageData(e){return r(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/productservice?Productserviceid=${e}`)}))}}class l extends o{constructor(){super(),this.container=document.createElement("div"),this.selectionDiv=document.createElement("div"),this.themeOptions=document.createElement("div"),this.selectedTheme=document.createElement("span"),this.init()}init(){this.container.classList.add("tb-custom-theme-selection");const e=document.createElement("button");e.classList.add("theme-select-button"),e.setAttribute("aria-haspopup","listbox"),this.selectedTheme.classList.add("selected-theme-value"),this.selectedTheme.textContent="Select Theme",e.appendChild(this.selectedTheme),this.container.appendChild(e),e.onclick=t=>{t.preventDefault(),e.classList.contains("open")?this.closeSelection():(this.themeOptions.classList.toggle("show"),e.classList.toggle("open"),e.setAttribute("aria-expanded","true"))},this.selectionDiv.appendChild(e),this.container.appendChild(this.selectionDiv),this.initializeCategoryOptions()}initializeCategoryOptions(){this.themeOptions.className="theme-options-list",this.themeOptions.setAttribute("role","listbox"),this.getThemes().forEach((e=>{const t=document.createElement("div");t.className="theme-option",t.role="option",t.setAttribute("data-value",e.ThemeName),t.textContent=e.ThemeName;const i=this.getActiveTheme();i&&i.ThemeName===e.ThemeName&&(t.classList.add("selected"),this.selectedTheme.textContent=e.ThemeName),t.onclick=()=>{this.themeOptions.querySelectorAll(".theme-option").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),this.selectedTheme.textContent=e.ThemeName,this.saveSelectedTheme(e),this.closeSelection()},this.themeOptions.appendChild(t)})),this.selectionDiv.appendChild(this.themeOptions)}saveSelectedTheme(e){(new d).updateLocationTheme(e.ThemeId).then((t=>{this.setTheme(e)}))}closeSelection(){if(this.themeOptions.classList.contains("show")){this.themeOptions.classList.remove("show");const e=this.container.querySelector(".theme-select-button");e.setAttribute("aria-expanded","false"),e.classList.toggle("open")}}render(e){e.appendChild(this.container)}}class h{constructor(){this.container=document.getElementById("navbar-buttons"),this.init()}init(){const e=new i,n=new l;let s=new t("open-mapping","Tree",{labelId:"navbar_tree_label"}),o=new t("publish","Publish",{variant:"outline",labelId:"navbar_tree_label"});e.render(this.container),n.render(this.container),s.render(this.container),o.render(this.container)}render(e){e.appendChild(this.container)}}class m{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("tb-tabs");const e=document.createElement("button");e.id="pages-button",e.className="tb-tab-button active",e.setAttribute("data-tab","pages");const t=document.createElement("span");t.id="sidebar_tabs_pages_label",t.innerText="Pages",e.appendChild(t);const i=document.createElement("button");i.id="templates-button",i.className="tb-tab-button",i.setAttribute("data-tab","templates");const n=document.createElement("span");n.id="sidebar_tabs_templates_label",n.innerText="Templates",i.appendChild(n),this.container.appendChild(e),this.container.appendChild(i)}render(e){e.appendChild(this.container)}}class p{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="sidebar-section custom-select-container",this.container.id="select-container";const e=document.createElement("div");e.className="tb-dropdown";const t=document.createElement("div");t.className="tb-dropdown-header",t.innerHTML='\n            <span id="sidebar_select_action_label">Select Action</span>\n            <i class="fa fa-angle-down"></i>\n        ',e.appendChild(t),this.container.appendChild(e)}render(e){e.appendChild(this.container)}}class u{constructor(){this.container=document.createElement("div"),this.selectionDiv=document.createElement("div"),this.categoryOptions=document.createElement("div"),this.selectedCategory=document.createElement("span"),this.themeManager=new o,this.init()}init(){this.container.className="sidebar-section services-section",this.container.id="dropdownMenu",this.selectionDiv.className="tb-custom-category-selection";const e=document.createElement("button");e.className="category-select-button",e.setAttribute("aria-haspopup","listbox"),e.setAttribute("aria-expanded","false"),this.selectedCategory.className="selected-category-value",this.selectedCategory.textContent="General",e.appendChild(this.selectedCategory),e.onclick=t=>{t.preventDefault(),e.classList.contains("open")?this.closeSelection():(this.categoryOptions.classList.toggle("show"),e.classList.toggle("open"),e.setAttribute("aria-expanded","true"))},this.selectionDiv.appendChild(e),this.container.appendChild(this.selectionDiv),this.initializeCategoryOptions(),this.loadThemeIcons()}initializeCategoryOptions(){this.categoryOptions.className="category-options-list",this.categoryOptions.setAttribute("role","listbox"),["General","Services","Health","Living"].forEach((e=>{const t=document.createElement("div");t.className="category-option",t.role="option",t.setAttribute("data-value",e),t.textContent=e,t.onclick=()=>{this.categoryOptions.querySelectorAll(".category-option").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),this.selectedCategory.textContent=e,this.loadThemeIcons(e),this.closeSelection()},this.categoryOptions.appendChild(t)})),this.selectionDiv.appendChild(this.categoryOptions)}closeSelection(){if(this.categoryOptions.classList.contains("show")){this.categoryOptions.classList.remove("show");const e=this.container.querySelector(".category-select-button");e.setAttribute("aria-expanded","false"),e.classList.toggle("open")}}loadThemeIcons(e="General"){document.querySelectorAll("#icons-list").forEach((e=>e.remove()));const t=document.createElement("div");t.classList.add("icons-list"),t.id="icons-list",new s(this.themeManager,e).render(t),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class g extends o{constructor(){super(),this.container=document.createElement("div"),this.init()}init(){this.container.className="sidebar-section theme-section",this.container.style.paddingTop="0px";const e=this.getActiveThemeColors();new n(e,"theme-color-palette").render(this.container)}render(e){e.appendChild(this.container)}}class v{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="bg-section";const e=document.createElement("button");e.className="add-image",e.id="image-bg",e.innerHTML='\n            <span class="plus">\n               <i class="fa fa-plus"></i>\n            </span>\n            <span class="image-icon">\n                <i class="fa fa-image"></i>\n            </span>\n        ';const t=document.createElement("div");t.className="slider-wrapper",t.id="slider-wrapper",t.innerHTML='\n            <input\n                type="range"\n                id="bg-opacity"\n                min="0"\n                max="100"\n                value="80"\n                oninput="document.getElementById(\'valueDisplay\').textContent = this.value + \' %\'"\n                disabled>\n            <span class="value-display" id="valueDisplay">0%</span>\n        ',this.container.appendChild(e),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class b{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("tile-img-container"),this.container.id="tile-img-container";const e=document.createElement("img");e.alt="Tile Image",e.src="https://staging.comforta.yukon.software/media/receptie-197@3x.png",e.className="tile-img-thumbnail";const t=document.createElement("button");t.className="tile-img-delete-button",t.id="tile-img-delete-button",t.innerHTML='<i class="fa fa-xmark"></i>',this.container.appendChild(e),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class f{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("tile-img-section");const e=new b;(new v).render(this.container),e.render(this.container)}render(e){e.appendChild(this.container)}}class y{constructor(){this.input=document.createElement("input"),this.init()}init(){this.input.type="text",this.input.placeholder="Enter a title",this.input.classList.add("tb-form-control"),this.input.id="tile-title",this.input.addEventListener("input",(e=>{}))}render(e){e.appendChild(this.input)}}class C{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="text-color-palette text-colors",this.container.id="text-color-palette",Object.entries({color1:"#ffffff",color2:"#333333"}).forEach((([e,t])=>{const i=document.createElement("div");i.className="color-item";const n=document.createElement("input");n.type="radio",n.id=`text-color-${e}`,n.name="text-color",n.value=e;const s=document.createElement("label");s.className="color-box",s.setAttribute("for",`text-color-${e}`),s.style.backgroundColor=t,s.setAttribute("data-tile-color",t),i.appendChild(n),i.appendChild(s),this.container.appendChild(i),n.onclick=()=>{}}))}render(e){e.appendChild(this.container)}}class T{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("text-alignment");const e=document.createElement("div");e.classList.add("align-item"),e.innerHTML='\n            <input type="radio" id="tile-left"\n                name="alignment" value="left" />\n            <label for="tile-left" class="fas fa-align-left">\n            </label>\n        ';const t=document.createElement("div");t.classList.add("align-item"),t.innerHTML='\n            <input type="radio" id="tile-center"\n                     name="alignment" value="center" />\n            <label for="tile-center">\n                <svg xmlns="http://www.w3.org/2000/svg"\n                width="12.7" height="14.626"\n                viewBox="0 0 12.7 14.626">\n                <path id="Group_2344-converted"\n                    data-name="Group 2344-converted"\n                    d="M5.863,1.868V3.736L5.031,2.9,4.2,2.073l-.336.341-.336.342,1.411,1.41L6.35,5.577,7.758,4.17,9.165,2.762l-.333-.333L8.5,2.1l-.831.817-.83.817V0H5.863V1.868M0,7.313v.794H12.7V6.519H0v.794m4.937,3.149-1.4,1.4.333.333.334.333.83-.816.831-.817v3.729h.974V10.89l.832.832.831.832.336-.342.336-.341L7.766,10.465c-.773-.773-1.41-1.406-1.416-1.406s-.642.631-1.413,1.4"\n                    fill-rule="evenodd" fill="#696969" />\n                </svg>\n            </label>\n        ',e.onclick=()=>{},t.onclick=()=>{},this.container.appendChild(e),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class E{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("title-style");const e=new C,t=new T;e.render(this.container),t.render(this.container)}render(e){e.appendChild(this.container)}}class I{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="sidebar-section title-section";const e=new y,t=new E;e.render(this.container),t.render(this.container)}render(e){e.appendChild(this.container)}}class w{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.id="menu-page-section";const e=new g,t=new f,i=new I,n=new p,s=new u;e.render(this.container),t.render(this.container),i.render(this.container),n.render(this.container),s.render(this.container)}render(e){e.appendChild(this.container)}}class P{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="tb-tab-content active-tab",this.container.id="pages-content",(new w).render(this.container)}render(e){e.appendChild(this.container)}}class x{constructor(){this.container=document.getElementById("tools-section"),this.init()}init(){const e=new m,t=new P;e.render(this.container),t.render(this.container)}render(e){e.appendChild(this.container)}}class A{constructor(){}setUpNavBar(){const e=document.getElementById("tb-navbar");document.getElementById("navbar_title").textContent="App toolbox",(new h).render(e)}setUpSideBar(){const e=document.getElementById("tb-sidebar");(new x).render(e)}}const L=class{constructor(){this.config=e.getInstance(),this.toolboxManager=new A,this.config.isInitialized||console.error("ToolboxApp created before AppConfig was initialized!"),this.initialise()}initialise(){this.toolboxManager.setUpNavBar(),this.toolboxManager.setUpSideBar()}};window.App=class{constructor(t,i,n,s,o){e.getInstance().init(t,i,n,s,o),this.toolboxApp=new L}}})();