(()=>{"use strict";class e{constructor(){this._themes=[],this._services=[],this._forms=[],this._media=[],this._currentThemeId=null,this._organisationLogo=null,this._isInitialized=!1}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(e,t,i,n,a,s){this._isInitialized?console.warn("AppConfig already initialized - ignoring new data"):(this._themes=e,this._services=t,this._forms=i,this._media=n,this._currentThemeId=a,this._organisationLogo=s,this._isInitialized=!0)}get themes(){return this._themes}get services(){return this._services}get forms(){return this._forms}get media(){return this._media}set media(e){this._media=e}get currentThemeId(){return this._currentThemeId}set currentThemeId(e){this._currentThemeId=e}get organisationLogo(){return this._organisationLogo}get isInitialized(){return this._isInitialized}}e.instance=null;class t{constructor(e,t=300){this.preloaderElement=e,this.minDuration=t,this._loading=!1,this._startTime=0,this.transitionDuration=200}get loading(){return this._loading}set loading(e){this._loading=e,e?(this._startTime=performance.now(),this.showPreloader()):this.hidePreloader()}showPreloader(){this.preloaderElement.style.display="flex",requestAnimationFrame((()=>{this.preloaderElement.style.transform=`opacity ${this.transitionDuration}ms ease-in-out 0s`,this.preloaderElement.style.opacity="1"}))}hidePreloader(){const e=performance.now()-this._startTime;e>=this.minDuration?(this.preloaderElement.style.transition=`opacity ${this.transitionDuration}ms ease-in-out`,this.preloaderElement.style.opacity="0",setTimeout((()=>{this.preloaderElement.style.display="none"}),this.transitionDuration)):setTimeout((()=>{this.hidePreloader()}),this.minDuration-e)}}var i=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};const n=window.location.origin+(window.location.origin.startsWith("http://localhost")?"/ComfortaKBDevelopmentNETSQLServer":"");class a{constructor(){this.services=[],this.forms=[],this.media=[],this.pages=[],this.preloaderEl=document.getElementById("preloader"),this.config=e.getInstance(),this.init()}init(){this.services=this.config.services,this.forms=this.config.forms,this.media=[],this.pages=[],this.getPages(),this.getMediaFiles(),this.loadingManager=new t(this.preloaderEl)}fetchAPI(e){return i(this,arguments,void 0,(function*(e,t={},i=!1){const a={headers:{"Content-Type":"application/json"}};try{i||(this.loadingManager.loading=!0);const s=yield fetch(`${n}${e}`,Object.assign(Object.assign({},a),t));if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return yield s.json()}catch(t){throw console.error(`API Error (${e}):`,t),t}finally{i||(this.loadingManager.loading=!1)}}))}getPages(){return i(this,void 0,void 0,(function*(){const e=yield this.fetchAPI("/api/toolbox/pages/list",{},!0);return this.pages=e.SDT_PageCollection,e.SDT_PageCollection}))}getServices(){return i(this,void 0,void 0,(function*(){const e=yield this.fetchAPI("/api/toolbox/services",{},!0);return this.services=e.SDT_ProductServiceCollection,this.services}))}getSinglePage(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/toolbox/singlepage?Pageid=${e}`)}))}deletePage(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/toolbox/deletepage?Pageid=${e}`)}))}getPagesService(){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/pages/tree")}))}createNewPage(e,t){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/create-page",{method:"POST",body:JSON.stringify({PageName:e,PageJsonContent:JSON.stringify({})})})}))}updatePage(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/update-page",{method:"POST",body:JSON.stringify(e)},!0)}))}updatePagesBatch(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/update-pages-batch",{method:"POST",body:JSON.stringify(e)})}))}addPageChild(e,t){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/add-page-children",{method:"POST",body:JSON.stringify({ParentPageId:t,ChildPageId:e})})}))}createContentPage(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/create-content-page",{method:"POST",body:JSON.stringify({PageId:e})})}))}createDynamicFormPage(e,t){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/create-dynamic-form-page",{method:"POST",body:JSON.stringify({FormId:e,PageName:t})})}))}getLocationTheme(){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/location-theme")}))}updateLocationTheme(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/toolbox/update-location-theme",{method:"POST",body:JSON.stringify({ThemeId:e})})}))}getMediaFiles(){return i(this,void 0,void 0,(function*(){const e=yield this.fetchAPI("/api/toolbox/media",{},!0);return this.media=e.SDT_MediaCollection,e.SDT_MediaCollection}))}deleteMedia(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/media/delete?MediaId=${e}`)}))}uploadFile(e,t,n,a){return i(this,void 0,void 0,(function*(){if(!e)throw new Error("Please select a file!");return yield this.fetchAPI("/api/media/upload",{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:JSON.stringify({MediaName:t,MediaImageData:e,MediaSize:n,MediaType:a})},!0)}))}uploadLogo(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/media/upload/logo",{method:"POST",body:JSON.stringify({LogoUrl:e})})}))}uploadProfileImage(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI("/api/media/upload/profile",{method:"POST",body:JSON.stringify({ProfileImageUrl:e})})}))}getContentPageData(e){return i(this,void 0,void 0,(function*(){return yield this.fetchAPI(`/api/productservice?Productserviceid=${e}`)}))}}class s{constructor(e){this.pageId=e}updateTime(){const e=new Date;let t=e.getHours();const i=t>=12?"PM":"AM";return t%=12,t=t||12,`${t}:${e.getMinutes().toString().padStart(2,"0")} ${i}`}}class o{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("header");const e=new s("clock"),t=document.createElement("span");t.id="clock",t.textContent=e.updateTime();const i=document.createElement("span");i.classList.add("icons");const n=document.createElement("i");n.classList.add("fas","fa-signal");const a=document.createElement("i");a.classList.add("fas","fa-wifi");const o=document.createElement("i");o.classList.add("fas","fa-battery"),i.appendChild(n),i.appendChild(a),i.appendChild(o),this.container.appendChild(t),this.container.appendChild(i)}render(e){e.appendChild(this.container)}}class l{constructor(){this.container=document.createElement("div"),this.editor=new S,this.init()}init(){this.container.classList.add("home-app-bar");const e=document.createElement("div");e.classList.add("logo-added");const t=document.createElement("img");t.src=this.editor.organisationLogo,t.style.height="35px",e.appendChild(t);const i=document.createElement("div");i.classList.add("profile-section"),i.style.display="flex",i.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="18" viewBox="0 0 19.422 21.363">\n                <path id="Path_1327" data-name="Path 1327" d="M15.711,5a6.8,6.8,0,0,0-3.793,12.442A9.739,9.739,0,0,0,6,26.364H7.942a7.769,7.769,0,1,1,15.537,0h1.942A9.739,9.739,0,0,0,19.5,17.442,6.8,6.8,0,0,0,15.711,5Zm0,1.942A4.855,4.855,0,1,1,10.855,11.8,4.841,4.841,0,0,1,15.711,6.942Z" transform="translate(-6 -5)" fill="#fff"></path>\n            </svg>\n        ',this.container.appendChild(e),this.container.appendChild(i)}render(e){e.appendChild(this.container)}}class r{constructor(e,t){this.title=t||"Page Name",this.id=e,this.container=document.createElement("div"),this.editor=new S,this.init()}init(){this.container.classList.add("app-bar");const e=document.createElement("svg");e.innerHTML='\n          <svg class="content-back-button" xmlns="http://www.w3.org/2000/svg" data-name="Group 14" width="47" height="47" viewBox="0 0 47 47">\n            <g id="Ellipse_6" data-name="Ellipse 6" fill="none" stroke="#262626" stroke-width="1">\n              <circle cx="23.5" cy="23.5" r="23.5" stroke="none"></circle>\n              <circle cx="23.5" cy="23.5" r="23" fill="none"></circle>\n            </g>\n            <path id="Icon_ionic-ios-arrow-round-up" data-name="Icon ionic-ios-arrow-round-up" d="M13.242,7.334a.919.919,0,0,1-1.294.007L7.667,3.073V19.336a.914.914,0,0,1-1.828,0V3.073L1.557,7.348A.925.925,0,0,1,.263,7.341.91.91,0,0,1,.27,6.054L6.106.26h0A1.026,1.026,0,0,1,6.394.07.872.872,0,0,1,6.746,0a.916.916,0,0,1,.64.26l5.836,5.794A.9.9,0,0,1,13.242,7.334Z" transform="translate(13 30.501) rotate(-90)" fill="#262626"></path>\n          </svg>\n        ',e.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector(`#${this.id}-frame`);if(t){let e=t.nextElementSibling;for(;e;){const t=e;e=e.nextElementSibling,t.remove()}t.remove()}}));const t=document.createElement("h1");t.className="title",t.setAttribute("title",this.title||"Page Name"),t.textContent=this.title||"Page Name",this.container.appendChild(e),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class c{constructor(e,t=!1,i){this.container=document.createElement("div"),this.id=e,this.isHome=t,this.pageName=i,this.init()}init(){this.container.className="mobile-frame",this.container.id=`${this.id}-frame`,this.container.setAttribute("data-pageid","1");const e=new o,t=new l,i=new r(this.id,this.pageName);e.render(this.container),this.isHome?t.render(this.container):i.render(this.container);const n=document.createElement("div");n.id=this.id,this.container.appendChild(n)}render(e){e.appendChild(this.container)}}class d{constructor(e){this.pageId=e,this.container=document.createElement("div"),this.init()}init(){this.container.style.justifyContent="center",this.container.className="frame-list",this.container.id="child-container",new c(`gjs-${this.pageId}`,!0).render(this.container)}render(e){e.appendChild(this.container)}}class h{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.style.display="none",this.container.className="navigator page-navigator-left",this.container.innerHTML='<span id="scroll-left"><i class="fa fa-arrow-left-long"></i></span>',this.container.addEventListener("click",(()=>{}))}render(e){e.appendChild(this.container)}}class p{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.style.display="none",this.container.className="navigator page-navigator-right",this.container.innerHTML='<span id="scroll-right"><i class="fa fa-arrow-left-long"></i></span>',this.container.addEventListener("click",(()=>{}))}render(e){e.appendChild(this.container)}}const m={AppVersions:[{AppVersionId:"ec74ef1d-b7b4-4195-bed4-5948cc4207d1",AppVersionName:"Version 1",LocationId:"a81dfcef-c383-44ce-8cad-891516e1a568",IsActive:!1,Pages:[{PageName:"Home",PageId:"1741711658425",PageType:"Menu",PageStructure:{Rows:[{Id:"c7a5d3e9-4b41-4f8d-9",Tiles:[{Id:"b3e5a7c9-4d41",Name:"Welcome",Text:"Welcome",Color:"#ffffff",Align:"center",Icon:"home",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658426",ObjectUrl:"1741711658426"},TilePermissionName:""}]},{Id:"a5d7e3c9-4b41-4f8d",Tiles:[{Id:"f2c5a3d7",Name:"Services",Text:"Services",Color:"#ffffff",Align:"left",Icon:"cogs",BGColor:"#f0f0f0",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658426",ObjectUrl:"1741711658426"},TilePermissionName:""},{Id:"e8f5a3c7-2b41-4d9e-91",Name:"Products",Text:"Products",Color:"#333333",Align:"center",Icon:"shopping-cart",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658425",ObjectUrl:"1741711658425"},TilePermissionName:""},{Id:"c3d5a7e9-4b41-4f8c",Name:"Contact",Text:"Contact",Color:"#ffffff",Align:"left",Icon:"phone",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658427",ObjectUrl:"1741711658427"},TilePermissionName:""}]},{Id:"c5f4e1d2",Tiles:[{Id:"a3e12c47-8f49",Name:"About Us",Text:"About Us",Color:"#ffffff",Align:"center",Icon:"info",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658426",ObjectUrl:"1741711658426"},TilePermissionName:""},{Id:"ed16cc57e18d",Name:"FAQ",Text:"FAQ",Color:"#333333",Align:"left",Icon:"question-circle",BGColor:"#f0f0f0",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658425",ObjectUrl:"1741711658425"},TilePermissionName:""}]}]}},{PageName:"About",PageId:"1741711658426",PageType:"Menu",PageStructure:{Rows:[{Id:"a4836934b094",Tiles:[{Id:"a51e94dd089d",Name:"Company History",Text:"Company History",Color:"#ffffff",Align:"center",Icon:"history",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658425",ObjectUrl:"1741711658425"},TilePermissionName:""}]}]}},{PageName:"Contact",PageId:"1741711658427",PageType:"Menu",PageStructure:{Rows:[{Id:"Row1",Tiles:[{Id:"f7fa1247c949",Name:"Email Us",Text:"Email Us",Color:"#333333",Align:"left",Icon:"envelope",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658425",ObjectUrl:"1741711658425"},TilePermissionName:""}]}]}}]},{AppVersionId:"fc84ef2d-c7b4-5195-aed4-6948cc4207e2",AppVersionName:"Version 2",LocationId:"b81dfcef-c383-44ce-8cad-891516e1a569",IsActive:!0,Pages:[{PageName:"Home",PageId:"1741711658428",PageType:"Menu",PageStructure:{Rows:[{Id:"c217ac29d20",Tiles:[{Id:"b33d-4003-9",Name:"Our Company",Text:"Our Company",Color:"#333333",Align:"center",Icon:"building",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658429",ObjectUrl:"1741711658429"},TilePermissionName:""}]},{Id:"c2e6-4bbd-9494",Tiles:[{Id:"e34d-4ad5-99d1",Name:"Portfolio",Text:"Portfolio",Color:"#ffffff",Align:"left",Icon:"briefcase",BGColor:"#f0f0f0",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658428",ObjectUrl:"1741711658428"},TilePermissionName:""},{Id:"a2ac-48c0",Name:"Team",Text:"Team",Color:"#333333",Align:"center",Icon:"users",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658429",ObjectUrl:"1741711658429"},TilePermissionName:""},{Id:"f9bb-45f6",Name:"Testimonials",Text:"Testimonials",Color:"#ffffff",Align:"left",Icon:"comment",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658430",ObjectUrl:"1741711658430"},TilePermissionName:""}]},{Id:"a9c2-2f6e4",Tiles:[{Id:"afa3-e1f82b",Name:"Location",Text:"Location",Color:"#ffffff",Align:"center",Icon:"map-marker",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658430",ObjectUrl:"1741711658430"},TilePermissionName:""},{Id:"a01c-f7fa12",Name:"Blog",Text:"Blog",Color:"#333333",Align:"left",Icon:"newspaper-o",BGColor:"#f0f0f0",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658428",ObjectUrl:"1741711658428"},TilePermissionName:""}]}]}},{PageName:"About",PageId:"1741711658429",PageType:"Menu",PageStructure:{Rows:[{Id:"a521-8c217ac",Tiles:[{Id:"b5c4-b16439",Name:"Our Mission",Text:"Our Mission",Color:"#ffffff",Align:"center",Icon:"flag",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658428",ObjectUrl:"1741711658428"},TilePermissionName:""}]}]}},{PageName:"Contact",PageId:"1741711658430",PageType:"Menu",PageStructure:{Rows:[{Id:"b500ee21-4414",Tiles:[{Id:"a50106cd-9fab",Name:"Call Us",Text:"Call Us",Color:"#333333",Align:"left",Icon:"phone",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658429",ObjectUrl:"1741711658429"},TilePermissionName:""}]}]}}]},{AppVersionId:"gc54ef1e-d8c5-6295-bed4-7958cc4207f3",AppVersionName:"Version 3",LocationId:"c81dfcef-c383-44ce-8cad-891516e1a570",IsActive:!1,Pages:[{PageName:"Home",PageId:"1741711658431",PageType:"Menu",PageStructure:{Rows:[{Id:"ad584dd0-05d0",Tiles:[{Id:"a871c52a-9659",Name:"Solutions",Text:"Solutions",Color:"#ffffff",Align:"center",Icon:"lightbulb-o",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658432",ObjectUrl:"1741711658432"},TilePermissionName:""}]},{Id:"da3feee7-b33d",Tiles:[{Id:"fac1fea4-3611",Name:"Industries",Text:"Industries",Color:"#333333",Align:"left",Icon:"industry",BGColor:"#f0f0f0",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658431",ObjectUrl:"1741711658431"},TilePermissionName:""},{Id:"fc1ebbb8-0af0",Name:"Case Studies",Text:"Case Studies",Color:"#ffffff",Align:"center",Icon:"file-text",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658432",ObjectUrl:"1741711658432"},TilePermissionName:""},{Id:"b7e00604-9e22",Name:"Partners",Text:"Partners",Color:"#333333",Align:"left",Icon:"handshake-o",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658433",ObjectUrl:"1741711658433"},TilePermissionName:""}]},{Id:"c00dda9e-3f58",Tiles:[{Id:"c175e809-c2e6",Name:"Support",Text:"Support",Color:"#ffffff",Align:"center",Icon:"life-ring",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658433",ObjectUrl:"1741711658433"},TilePermissionName:""},{Id:"ab78be0c-e34d",Name:"Resources",Text:"Resources",Color:"#333333",Align:"left",Icon:"book",BGColor:"#f0f0f0",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658431",ObjectUrl:"1741711658431"},TilePermissionName:""}]}]}},{PageName:"About",PageId:"1741711658432",PageType:"Menu",PageStructure:{Rows:[{Id:"f2df24ad-b706",Tiles:[{Id:"abdb1d9b-87a5",Name:"Our Story",Text:"Our Story",Color:"#333333",Align:"center",Icon:"book",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658431",ObjectUrl:"1741711658431"},TilePermissionName:""}]}]}},{PageName:"Contact",PageId:"1741711658433",PageType:"Menu",PageStructure:{Rows:[{Id:"dfb3f8bf-a2ac",Tiles:[{Id:"c179e942-f9bb",Name:"Get In Touch",Text:"Get In Touch",Color:"#ffffff",Align:"left",Icon:"envelope-o",BGColor:"#7f3e3a",BGImageUrl:"",Opacity:"0",Action:{ObjectType:"Page",ObjectId:"1741711658432",ObjectUrl:"1741711658432"},TilePermissionName:""}]}]}}]}]},g='\ndata-gjs-draggable="false"\ndata-gjs-selectable="true"\ndata-gjs-editable="false"\ndata-gjs-highlightable="false"\ndata-gjs-droppable="false"\ndata-gjs-resizable="false"\ndata-gjs-hoverable="false"\n',u='\ndata-gjs-draggable="false"\ndata-gjs-selectable="false"\ndata-gjs-editable="false"\ndata-gjs-highlightable="false"\ndata-gjs-droppable="false"\ndata-gjs-resizable="false"\ndata-gjs-hoverable="false"\n',f='\ndata-gjs-type="template-wrapper"\ndata-gjs-draggable="false"\ndata-gjs-selectable="false"\ndata-gjs-editable="false"\ndata-gjs-highlightable="true"\ndata-gjs-droppable="[data-gjs-type=\'tile-wrapper\']"\n';class v{constructor(e){this.data=e}generateTile(e,t,i){return`\n      <div\ndata-gjs-draggable="true"\ndata-gjs-selectable="false"\ndata-gjs-editable="false"\ndata-gjs-highlightable="false"\ndata-gjs-droppable="false"\ndata-gjs-resizable="false"\ndata-gjs-hoverable="false"\ndata-gjs-type="tile-wrapper"\n class="template-wrapper" id="${e.Id}">\n        <div ${g} class="template-block${t?" high-priority-template":""}" \n          style="background-color: ${e.BGColor}; color: ${e.Color}; text-align: ${e.Align};\n          ${i?"align-items: center; justify-content: center;":""}; \n          ${e.BGImageUrl?`background-image: url('${e.BGImageUrl}');\n          background-size: cover;\n          background-position: center;\n          background-blend-mode: overlay;`:""}">\n          \n          <div ${u} class="tile-icon-section">\n            <span ${u} class="tile-close-icon top-right">×</span>\n            <span ${u} title="${e.Icon}" class="tile-icon">${e.Icon}</span>\n          </div>\n          \n          <div ${u} class="tile-title-section" style="${i?"text-align: center;":"text-align: left"}">\n            <span ${u} class="tile-close-icon top-right">×</span>\n            <span ${u} class="tile-title">${e.Text}</span>\n          </div>\n        </div>\n        ${t?"":`\n          <button ${u} title="Delete tile" class="action-button delete-button">&minus;</button>`}\n        <button ${u} title="Add tile right" class="action-button add-button-right">+</button>\n        <button ${u} title="Add tile below" class="action-button add-button-bottom">&plus;</button>\n      </div>\n    `}generateRow(e,t){const i=0===t&&1===e.Tiles.length,n=3===e.Tiles.length,a=e.Tiles.map(((e,t)=>this.generateTile(e,i&&0===t,n))).join("");return`<div id="${e.Id}" ${f} class="container-row">${a}</div>`}generateHTML(){const e=`\n      <div ${u} id="frame-container" data-gjs-type="template-wrapper" class="frame-container">\n        <div ${u} class="container-column">\n          ${this.data.PageStructure.Rows.map(((e,t)=>this.generateRow(e,t))).join("")}\n        </div>\n      </div>\n    `;return this.filterHTML(e)}filterHTML(e){const t=document.createElement("div");return t.innerHTML=e,t.querySelectorAll(".container-row").forEach((e=>{3===e.querySelectorAll(".template-block").length&&e.querySelectorAll(".add-button-right").forEach((e=>{e.style.display="none"}))})),t.innerHTML}}class b{constructor(e,t){this.pageId=e,this.pageData=t,this.editorManager=new S,this.editorEvents=new w(this.editorManager)}init(){this.createNewEditor();const e=this.editorManager.initializeGrapesEditor("gjs-"+this.pageId),t=new v(this.pageData).generateHTML();e.setComponents(t),this.editorEvents.init(e,this.pageId),this.editorManager.finalizeEditorSetup(e),localStorage.setItem(`data-${this.pageId}`,JSON.stringify(this.pageData))}createNewEditor(){const e=document.getElementById("child-container");new c("gjs-"+this.pageId,!1,this.pageData.PageName).render(e)}}const y=e=>{let t="";for(let i=0;i<e;i++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return t+(new Date).toISOString().replace(/[-:.TZ]/g,"")};class T{constructor(e){this.pageId=e}addFreshRow(e,t){var i;const n=JSON.parse(localStorage.getItem(`data-${this.pageId}`)||"{}"),a={Id:e,Tiles:[{Id:t,Name:"Title",Text:"Title",Color:"#333333",Align:"left",Icon:"home",BGColor:"transparent",BGImageUrl:"",Opacity:"50",Action:{ObjectType:"",ObjectId:"",ObjectUrl:""},TilePermissionName:""}]};null===(i=n.PageStructure.Rows)||void 0===i||i.push(a),localStorage.setItem(`data-${this.pageId}`,JSON.stringify(n))}addTile(e,t){const i={Id:t,Name:"Title",Text:"Title",Color:"#333",Align:"left",Icon:"home",BGColor:"transparent",BGImageUrl:"",Opacity:"50",Action:{ObjectType:"",ObjectId:"",ObjectUrl:""},TilePermissionName:""},n=JSON.parse(localStorage.getItem(`data-${this.pageId}`)||"{}"),a=n.PageStructure.Rows.find((t=>t.Id===e));a&&(a.Tiles.push(i),localStorage.setItem(`data-${this.pageId}`,JSON.stringify(n)))}removeTile(e,t){const i=JSON.parse(localStorage.getItem(`data-${this.pageId}`)||"{}"),n=i.PageStructure.Rows.find((e=>String(e.Id)===String(t)));n&&(n.Tiles=n.Tiles.filter((t=>t.Id!==e)),0===n.Tiles.length&&(i.PageStructure.Rows=i.PageStructure.Rows.filter((e=>e.Id!==n.Id))),localStorage.setItem(`data-${this.pageId}`,JSON.stringify(i)))}updateTile(e,t,i){const n=JSON.parse(localStorage.getItem(`data-${this.pageId}`)||"{}");n.PageStructure.Rows.forEach((n=>{n.Tiles.forEach((n=>{if(n.Id===e)if(t.includes(".")){const e=t.split(".");let a=n;for(let t=0;t<e.length-1;t++)a=a[e[t]];a[e[e.length-1]]=i}else n[t]=i}))})),localStorage.setItem(`data-${this.pageId}`,JSON.stringify(n))}getTile(e,t){const i=JSON.parse(localStorage.getItem(`data-${this.pageId}`)||"{}");if(console.log("data",i),e){const n=i.PageStructure.Rows.find((t=>t.Id===e));if(n)return console.log("row",n),n.Tiles.find((e=>e.Id===t))||null}return null}}class I{constructor(e){this.pageId=e||null}updateTile(e){this.rowComponent=e;const t=e.components(),i=t.length;t.forEach((e=>{const t=e.find(".add-button-right")[0];t&&t.addStyle({display:i>=3?"none":"flex"});const n={"justify-content":3===i?"center":"start","align-items":3===i?"center":"start"},a={"text-align":3===i?"center":"left"};this.updateAlignment(e,n,a),this.updateTileTitleLength(e,i),this.updateTileAttributes(e.getId(),"Align",n["justify-content"])}))}updateAlignment(e,t,i){const n=e.find(".template-block")[0],a=e.find(".tile-title-section")[0];n.addStyle(t),a.addStyle(i)}updateTileTitleLength(e,t){var i;const n=e.find(".tile-title")[0];if(n){const e=3===t?11:2===t?15:20,a=this.truncateText(e,(null===(i=n.getAttributes())||void 0===i?void 0:i.title)||n.getEl().innerText);3===t?n.components(this.wrapTileTitle(a)):n.components(a)}}truncateText(e,t){const i=window.innerWidth;return t.length>(i<=1440?e:e+4)?t.substring(0,i<=1440?e:e+4).trim()+"..":t}wrapTileTitle(e){const t=e.split(" ");return t.length>1?t[0]+"<br>"+t[1]:e.replace("<br>","")}updateTileAttributes(e,t,i){console.log(e,t,i);let n=i;"start"===i&&(n="left"),new T(this.pageId).updateTile(e,t,n)}}class C{constructor(e,t,i){this.event=e,this.editor=t,this.pageId=i,this.tileUpdate=new I(i),this.tileMapper=new T(this.pageId),this.init()}init(){this.addTileBottom(),this.addTileRight(),this.deleteTile(),this.removeTileIcon(),this.removeTileTile()}addTileBottom(){var e;const t=this.event.target.closest(".action-button.add-button-bottom");if(t){const i=t.closest(".template-wrapper");if(!i)return;let n=i.parentElement,a=null==n?void 0:n.parentElement;if(!n||!a)return;const s=Array.from(a.children).indexOf(n),o=this.editor.Components.getWrapper().find("#"+a.id)[0];if(!o)return;const l=this.editor.Components.addComponent(this.getTileRow());o.append(l,{at:s+1});const r=null===(e=l.find(".template-wrapper")[0])||void 0===e?void 0:e.getId();globalThis.tileManager.addFreshRow(l.getId(),r)}}addTileRight(){var e;const t=this.event.target.closest(".action-button.add-button-right");if(t){const i=t.closest(".template-wrapper"),n=this.editor.Components.getWrapper().find("#"+(null==i?void 0:i.id))[0];if(!n)return;const a=n.parent();if(a.components().filter((e=>"tile-wrapper"===e.get("type"))).length>=3)return;const s=this.editor.Components.addComponent(this.getTile()),o=n.index();a.append(s,{at:o+1}),this.tileUpdate.updateTile(a),globalThis.tileManager.addTile(null===(e=null==i?void 0:i.parentElement)||void 0===e?void 0:e.id,s.getId())}}deleteTile(){const e=this.event.target.closest(".action-button.delete-button");if(e){const t=e.closest(".template-wrapper");if(t){const e=this.editor.Components.getWrapper().find("#"+(null==t?void 0:t.id))[0],i=e.parent();e.remove(),this.tileUpdate.updateTile(i),globalThis.tileManager.removeTile(e.getId(),i.getId())}}}removeTileIcon(){const e=this.event.target.closest(".tile-close-icon");if(e){const t=e.parentElement,i=this.editor.Components.getWrapper().find("#"+(null==t?void 0:t.id))[0];this.checkTileHasIconOrTitle(i)?i.addStyle({display:"none"}):console.warn("Tile has no icon or title")}}removeTileTile(){const e=this.event.target.closest(".tile-close-title");if(e){const t=e.parentElement,i=this.editor.Components.getWrapper().find("#"+(null==t?void 0:t.id))[0];this.checkTileHasIconOrTitle(i)?i.addStyle({display:"none"}):console.warn("Tile has no icon or title")}}checkTileHasIconOrTitle(e){const t=e.parent();if(!t)return!1;const i=t.components(),n=i.some((e=>{var t;const i=null===(t=e.getStyle())||void 0===t?void 0:t.display;return e.getClasses().includes("tile-title-section")&&"none"!==i&&void 0!==i})),a=i.some((e=>{var t;const i=null===(t=e.getStyle())||void 0===t?void 0:t.display;return e.getClasses().includes("tile-icon-section")&&"none"!==i&&void 0!==i}));return n&&a}getTileRow(){const e=this.getTile();return`<div class="container-row" ${f} id="${y(8)}">${e}</div>`}getTile(){return`\n      <div ${u} class="template-wrapper" id="${y(8)}">\n        <div ${g} class="template-block" style="background-color: transparent; color: #fff justify-content: left">\n            <div ${u} id="igtdq" data-gjs-type="default" class="tile-icon-section">\n              <span ${u} id="is1dw" data-gjs-type="text" class="tile-close-icon top-right selected-tile-title">×</span>\n              <span ${u} id="ic26t" data-gjs-type="text" class="tile-icon">Title</span>\n            </div>\n            <div ${u} id="igtdq" data-gjs-type="default" class="tile-title-section">\n              <span ${u} id="is1dw" data-gjs-type="text" class="tile-close-icon top-right selected-tile-title">×</span>\n              <span ${u} style="display: block" id="ic26t" data-gjs-type="text" is-hidden="false" title="Title" class="tile-title">Title</span>\n            </div>\n        </div>\n        <button ${u} id="i9sxl" data-gjs-type="default" title="Delete template" class="action-button delete-button">&minus;</button>\n        <button ${u} id="ifvvi" data-gjs-type="default" title="Add template right" class="action-button add-button-right">+</button>\n        <button ${u} id="i4ubt" data-gjs-type="default" title="Delete template" class="action-button add-button-bottom">&plus;</button>\n      </div>\n    `}}class E{constructor(e,t){this.tileAttributes=t,this.selectedComponent=e}setTileAttributes(){this.setBgColorProperties(),this.setOpacityProperties(),this.setTileStyleProperties(),this.setTileActionProperties()}setBgColorProperties(){var e;const t=document.getElementById("theme-color-palette"),i=null===(e=this.selectedComponent.getStyle())||void 0===e?void 0:e["background-color"],n=this.tileAttributes.BGColor,a=null==t?void 0:t.children;for(let e=0;e<a.length;e++){const t=a[e].querySelector("input");i===n&&i===t.value?t.checked=!0:t.checked=!1}}setOpacityProperties(){var e;const t=this.tileAttributes.BGImageUrl,i=this.tileAttributes.Opacity,n=null===(e=this.selectedComponent.getStyle())||void 0===e?void 0:e["background-image"];let a="";if(n&&n.startsWith("url(")&&(a=n.replace(/^url\(["']?/,"").replace(/["']?\)$/,"")),a&&t){if(a===t){const e=document.querySelector(".tile-img-section");if(e){e.querySelector("#slider-wrapper").style.display="flex",e.querySelector("#bg-opacity").value=i;const n=e.querySelector("#tile-img-container");n.style.display="block";const a=n.querySelector("#tile-img-thumbnail");a&&(a.src=t)}}}else{const e=document.querySelector("#slider-wrapper"),t=document.querySelector("#tile-img-container");e.style.display="none",t.style.display="none"}}setTileStyleProperties(){const e=document.querySelector("#tile-title"),t=this.tileAttributes.Text;e.value=t;const i=this.tileAttributes.Color,n=document.querySelector("#text-color-palette"),a=null==n?void 0:n.querySelectorAll("input");null==a||a.forEach((e=>{e.value===i?e.checked=!0:e.checked=!1}))}setTileActionProperties(){const e=this.tileAttributes.Align,t=document.querySelector(".text-alignment"),i=null==t?void 0:t.querySelectorAll("input");null==i||i.forEach((t=>{t.value===e?t.checked=!0:t.checked=!1}))}setActionProperties(){}}class w{constructor(e){this.handleComponentAdd=e=>{var t;const i=e.parent();i&&(null===(t=i.getEl())||void 0===t?void 0:t.classList.contains("container-row"))&&3===i.components().filter((e=>"tile-wrapper"===e.get("type"))).length&&console.log("more than 3")},this.editorManager=e}init(e,t){this.editor=e,this.pageId=t,this.onLoad(),this.onDragAndDrop(),this.onSelected()}onLoad(){void 0!==this.editor&&this.editor.getWrapper().view.el.addEventListener("click",(e=>{this.tileManager=new C(e,this.editor,this.pageId)}))}onDragAndDrop(){let e,t;this.editor.on("component:drag:start",(t=>{e=t.parent})),this.editor.on("component:drag:end",(i=>{t=i.parent;const n=t.getEl();if(n&&n.classList.contains("container-row")){i.parent.components().filter((e=>"tile-wrapper"===e.get("type"))).length>3&&(i.target.remove(),this.editor.UndoManager.undo());const n=new I;n.updateTile(t),n.updateTile(e),this.onTileUpdate(t)}}))}onSelected(){this.editor.on("component:selected",(e=>{globalThis.selectedComponent=e,globalThis.tileManager=new T(this.pageId),this.setTileProperties(),this.createChildEditor()})),this.editor.on("component:deselected",(()=>{globalThis.selectedComponent=null}))}onTileUpdate(e){var t;e&&(null===(t=e.getEl())||void 0===t?void 0:t.classList.contains("container-row"))&&(this.editor.off("component:add",this.handleComponentAdd),this.editor.on("component:add",this.handleComponentAdd))}createNewEditor(){}setTileProperties(){const e=globalThis.selectedComponent,t=e.parent(),i=t.parent(),n=globalThis.tileManager.getTile(i.getId(),t.getId());e&&n&&(this.tileProperties=new E(e,n),this.tileProperties.setTileAttributes())}createChildEditor(){var e;const t=globalThis.selectedComponent.parent(),i=t.parent(),n=globalThis.tileManager.getTile(i.getId(),t.getId());if(console.log(i.getId(),t.getId()),n.Action.ObjectId){const t=n.Action.ObjectId,i=null===(e=m.AppVersions.find((e=>1==e.IsActive)))||void 0===e?void 0:e.Pages.find((e=>e.PageId===t));this.removeOtherEditors(),i&&new b(t,i).init()}else this.removeOtherEditors()}removeOtherEditors(){const e=document.querySelector(`#gjs-${this.pageId}-frame`);if(e){let t=e.nextElementSibling;for(;t;){const e=t;t=t.nextElementSibling,e.remove()}}}}var P=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};class S{constructor(){this.editors=[],this.config=e.getInstance(),this.organisationLogo=this.config.organisationLogo,this.toolboxService=new a,this.editorEvents=new w(this),this.jsonToGrapes=new v(this)}init(){var e;this.homepage=null===(e=m.AppVersions.find((e=>1==e.IsActive)))||void 0===e?void 0:e.Pages.find((e=>"Home"===e.PageName)),this.setUpEditorFrame(),this.setUpEditor()}setUpEditorFrame(){var e;const t=new h,i=new p,n=new d(null===(e=this.homepage)||void 0===e?void 0:e.PageId),a=document.getElementById("main-content");t.render(a),n.render(a),i.render(a)}setUpEditor(){return P(this,void 0,void 0,(function*(){var e;const t=this.initializeGrapesEditor(`gjs-${null===(e=this.homepage)||void 0===e?void 0:e.PageId}`);this.finalizeEditorSetup(t),yield this.loadHomePage(t)}))}loadHomePage(e){return P(this,void 0,void 0,(function*(){var t,i;console.log("loadHomePage",this.homepage);const n=new v(this.homepage).generateHTML();e.setComponents(n),this.editorEvents.init(e,null===(t=this.homepage)||void 0===t?void 0:t.PageId),localStorage.setItem(`data-${null===(i=this.homepage)||void 0===i?void 0:i.PageId}`,JSON.stringify(this.homepage))}))}initializeGrapesEditor(e){return grapesjs.init({container:`#${e}`,fromElement:!0,height:"100%",width:"auto",canvas:{styles:["https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css","/DVelop/Bootstrap/Shared/fontawesome_vlatest/css/all.min.css?202521714271081","https://fonts.googleapis.com/css2?family=Inter:opsz@14..32&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap","/Resources/UCGrapes1/src/css/toolbox.css"]},baseCss:" ",dragMode:"normal",panels:{defaults:[]},sidebarManager:!1,storageManager:!1,modal:!1,commands:!1,hoverable:!1,highlightable:!1,selectable:!1})}finalizeEditorSetup(e){e.getWrapper().set({selectable:!1,droppable:!1,draggable:!1,hoverable:!1});const t=e.Canvas.getElement();t&&t.style.setProperty("height","calc(100% - 100px)","important")}updateEditors(e,t,i){}}class L{constructor(e,t,i={}){if(this.button=document.createElement("button"),this.button.id=e,this.button.className=`tb-btn tb-btn-${i.variant||"primary"}`,i.svg){const e=(new DOMParser).parseFromString(i.svg,"image/svg+xml").documentElement;this.button.appendChild(e)}const n=document.createElement("span");i.labelId&&(n.id=i.labelId),n.textContent=t,this.button.appendChild(n)}render(e){e.appendChild(this.button)}}class A{constructor(){this.container=document.createElement("div"),this.undoButton=document.createElement("button"),this.redoButton=document.createElement("button"),this.init()}init(){this.container.classList.add("edit-actions"),this.undoButton.id="undo",this.undoButton.className="btn-transparent",this.undoButton.title="Undo (ctrl+z)",this.undoButton.innerHTML="<span class='fa fa-undo'></span>",this.undoButton.addEventListener("click",this.handleUndo),this.redoButton.id="redo",this.redoButton.className="btn-transparent",this.redoButton.title="Redo (ctrl+shift+z)",this.redoButton.innerHTML="<span class='fa fa-redo'></span>",this.redoButton.addEventListener("click",this.handleRedo),this.container.appendChild(this.undoButton),this.container.appendChild(this.redoButton)}handleUndo(){console.log("Undo action triggered")}handleRedo(){console.log("Redo action triggered")}render(e){e.appendChild(this.container)}}class N{constructor(e,t){this.containerId=t,this.paletteContainer=document.createElement("div"),this.paletteContainer.className="color-palette",this.paletteContainer.id=t,Object.entries(e).forEach((([e,t])=>{const i=document.createElement("div");i.className="color-item";const n=document.createElement("input");n.type="radio",n.id=`color-${e}`,n.name="theme-color",n.value=t;const a=document.createElement("label");a.htmlFor=`color-${e}`,a.className="color-box",a.setAttribute("data-tile-bgcolor",t),a.style.backgroundColor=t,i.appendChild(n),i.appendChild(a),i.addEventListener("click",(e=>{e.preventDefault();const i=globalThis.selectedComponent;if(!i)return;const a=i.parent(),s=a.parent(),o=globalThis.tileManager.getTile(s.getId(),a.getId());if(null==o?void 0:o.BGImageUrl)return;const l=i.getStyle()["background-color"];i.addStyle({"background-color":l===t?"transparent":t}),globalThis.tileManager.updateTile(i.parent().getId(),"BGColor",t),n.checked=l!==t})),this.paletteContainer.appendChild(i)}))}render(e){e.appendChild(this.paletteContainer)}refresh(e){const t=document.getElementById(this.containerId);t?t.replaceWith(this.paletteContainer):e.appendChild(this.paletteContainer)}}class x{constructor(e,t){this.icons=[],this.iconsCategory="General",this.themeManager=e,this.iconsCategory=t,this.init()}init(){this.icons=[];const e=this.themeManager.getActiveThemeIcons();this.themeManager.getActiveTheme(),e.filter((e=>e.IconCategory===this.iconsCategory)).forEach((e=>{const t=document.createElement("div");t.classList.add("icon"),t.title=e.IconName,t.innerHTML=`${e.IconSVG}`,t.addEventListener("click",(t=>{var i;t.preventDefault();const n=globalThis.selectedComponent;if(!n)return;const a=n.find(".tile-icon")[0];if(!a)return;const s=null===(i=n.getStyle())||void 0===i?void 0:i.color,o=e.IconSVG.replace(/fill="#[^"]*"/g,`fill="${s||"white"}"`).replace("<svg",`<svg ${u}`);a.components(o),a.parent().addStyle({display:"block"}),globalThis.tileManager.updateTile(n.parent().getId(),"Icon",e.IconName)})),this.icons.push(t)}))}render(e){this.icons.forEach((t=>e.appendChild(t)))}}class O{constructor(){this.themes=[],this.config=e.getInstance(),this.setThemes(this.config.themes)}setThemes(e){this.themes=e}getThemes(){return this.themes}getActiveTheme(){return this.getThemes().find((e=>e.ThemeId===this.config.currentThemeId))}getActiveThemeIcons(){const e=this.getActiveTheme();return e?e.ThemeIcons:[]}getActiveThemeColors(){const e=this.getActiveTheme();return e?e.ThemeColors:{}}setTheme(e){this.config.currentThemeId=e.ThemeId,this.updateColorPallete(e.ThemeColors),this.updateThemeIcons()}updateColorPallete(e){const t=new N(e,"theme-color-palette"),i=document.querySelector(".sidebar-section .theme-section");t.refresh(i)}updateThemeIcons(){const e=document.getElementById("icons-list");e.classList.add("icons-list"),e.id="icons-list",e.innerHTML="",new x(this,"General").render(e)}}class M extends O{constructor(){super(),this.container=document.createElement("div"),this.selectionDiv=document.createElement("div"),this.themeOptions=document.createElement("div"),this.selectedTheme=document.createElement("span"),this.init()}init(){this.container.classList.add("tb-custom-theme-selection");const e=document.createElement("button");e.classList.add("theme-select-button"),e.setAttribute("aria-haspopup","listbox"),this.selectedTheme.classList.add("selected-theme-value"),this.selectedTheme.textContent="Select Theme",e.appendChild(this.selectedTheme),this.container.appendChild(e),e.onclick=t=>{t.preventDefault(),e.classList.contains("open")?this.closeSelection():(this.themeOptions.classList.toggle("show"),e.classList.toggle("open"),e.setAttribute("aria-expanded","true"))},this.selectionDiv.appendChild(e),this.container.appendChild(this.selectionDiv),this.initializeCategoryOptions()}initializeCategoryOptions(){this.themeOptions.className="theme-options-list",this.themeOptions.setAttribute("role","listbox"),this.getThemes().forEach((e=>{const t=document.createElement("div");t.className="theme-option",t.role="option",t.setAttribute("data-value",e.ThemeName),t.textContent=e.ThemeName;const i=this.getActiveTheme();i&&i.ThemeName===e.ThemeName&&(t.classList.add("selected"),this.selectedTheme.textContent=e.ThemeName),t.onclick=()=>{this.themeOptions.querySelectorAll(".theme-option").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),this.selectedTheme.textContent=e.ThemeName,this.saveSelectedTheme(e),this.closeSelection()},this.themeOptions.appendChild(t)})),this.selectionDiv.appendChild(this.themeOptions)}saveSelectedTheme(e){(new a).updateLocationTheme(e.ThemeId).then((t=>{this.setTheme(e)}))}closeSelection(){if(this.themeOptions.classList.contains("show")){this.themeOptions.classList.remove("show");const e=this.container.querySelector(".theme-select-button");e.setAttribute("aria-expanded","false"),e.classList.toggle("open")}}render(e){e.appendChild(this.container)}}class j extends O{constructor(){super(),this.container=document.createElement("div"),this.selectionDiv=document.createElement("div"),this.versionSelection=document.createElement("div"),this.activeVersion=document.createElement("span"),this.init()}init(){this.container.classList.add("tb-custom-theme-selection");const e=document.createElement("button");e.classList.add("theme-select-button"),e.setAttribute("aria-haspopup","listbox"),this.activeVersion.classList.add("selected-theme-value"),this.activeVersion.textContent="Select Theme",e.appendChild(this.activeVersion),this.container.appendChild(e),e.onclick=t=>{t.preventDefault(),e.classList.contains("open")?this.closeSelection():(this.versionSelection.classList.toggle("show"),e.classList.toggle("open"),e.setAttribute("aria-expanded","true"))},this.selectionDiv.appendChild(e),this.container.appendChild(this.selectionDiv),this.initializeCategoryOptions()}initializeCategoryOptions(){this.versionSelection.className="theme-options-list",this.versionSelection.setAttribute("role","listbox"),m.AppVersions.forEach((e=>{const t=document.createElement("div");t.className="theme-option",t.role="option",t.setAttribute("data-value",e.AppVersionName),t.textContent=e.AppVersionName;const i=document.createElement("span");i.className="clone-version fa fa-clone",i.title="Duplicate",t.append(i),this.getActiveTheme(),e.IsActive&&(t.classList.add("selected"),this.activeVersion.textContent=e.AppVersionName),t.onclick=()=>{this.versionSelection.querySelectorAll(".theme-option").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),this.activeVersion.textContent=e.AppVersionName,this.closeSelection()},this.versionSelection.appendChild(t)}));const e=document.createElement("div");e.className="theme-option",e.innerHTML='<i class="fa fa-plus"></i> Create new version"',e.onclick=()=>{},this.versionSelection.appendChild(e),this.selectionDiv.appendChild(this.versionSelection)}closeSelection(){if(this.versionSelection.classList.contains("show")){this.versionSelection.classList.remove("show");const e=this.container.querySelector(".theme-select-button");e.setAttribute("aria-expanded","false"),e.classList.toggle("open")}}render(e){e.appendChild(this.container)}}class B{constructor(){this.container=document.getElementById("navbar-buttons"),this.init()}init(){const e=new A,t=new M,i=new j;let n=new L("open-mapping","Tree",{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="18.818" height="16" viewBox="0 0 18.818 18">\n        <path id="Path_993" data-name="Path 993" d="M19.545,5a3.283,3.283,0,0,0-3.273,3.273A3.228,3.228,0,0,0,16.784,10l-2.541,3.177H10.427a3.273,3.273,0,1,0,0,1.636h3.816L16.784,18a3.229,3.229,0,0,0-.511,1.732,3.273,3.273,0,1,0,3.273-3.273,3.207,3.207,0,0,0-1.563.419L15.685,14l2.3-2.873a3.207,3.207,0,0,0,1.563.419,3.273,3.273,0,0,0,0-6.545Zm0,1.636a1.636,1.636,0,1,1-1.636,1.636A1.623,1.623,0,0,1,19.545,6.636ZM7.273,12.364A1.636,1.636,0,1,1,5.636,14,1.623,1.623,0,0,1,7.273,12.364Zm12.273,5.727a1.636,1.636,0,1,1-1.636,1.636A1.623,1.623,0,0,1,19.545,18.091Z" transform="translate(-4 -5)"></path>\n        </svg>',variant:"outline",labelId:"navbar_tree_label"}),a=new L("publish","Publish",{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="13" height="16" viewBox="0 0 13 18">\n        <path id="Path_958" data-name="Path 958" d="M13.5,3.594l-.519.507L7.925,9.263l1.038,1.06,3.814-3.9V18.644h1.444V6.429l3.814,3.9,1.038-1.06L14.019,4.1ZM7,20.119v1.475H20V20.119Z" transform="translate(-7 -3.594)" fill="#fff"></path>\n      </svg>',labelId:"navbar_tree_label"});e.render(this.container),i.render(this.container),t.render(this.container),n.render(this.container),a.render(this.container)}render(e){e.appendChild(this.container)}}class k{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("tb-tabs");const e=document.createElement("button");e.id="pages-button",e.className="tb-tab-button active",e.setAttribute("data-tab","pages");const t=document.createElement("span");t.id="sidebar_tabs_pages_label",t.innerText="Pages",e.appendChild(t);const i=document.createElement("button");i.id="templates-button",i.className="tb-tab-button",i.setAttribute("data-tab","templates");const n=document.createElement("span");n.id="sidebar_tabs_templates_label",n.innerText="Templates",i.appendChild(n),e.addEventListener("click",(t=>{t.preventDefault(),null==e||e.classList.add("active"),null==i||i.classList.remove("active"),this.switchTabs("pages-content","templates-content")})),i.addEventListener("click",(t=>{t.preventDefault(),null==i||i.classList.add("active"),null==e||e.classList.remove("active"),this.switchTabs("templates-content","pages-content")})),this.container.appendChild(e),this.container.appendChild(i)}switchTabs(e,t){const i=document.getElementById(e),n=document.getElementById(t);console.log(i,n),i.style.display="block",n.style.display="none"}render(e){e.appendChild(this.container)}}class U{constructor(e){this.categoryData=e,this.details=document.createElement("details"),this.init()}init(){this.details.className="category",this.details.setAttribute("data-category","Page"),this.createCategoryElement()}createCategoryElement(){const e=document.createElement("summary");e.innerText=`${this.categoryData.name}`;const t=document.createElement("i");t.className="fa fa-angle-right",e.appendChild(t);const i=document.createElement("div");i.className="search-container",i.innerHTML='\n            <i class="fas fa-search search-icon"></i>\n            <input type="text" placeholder="Search" class="search-input" />\n            <button title="Add New Service/Product Page" class="add-new-service">\n            <i class="fa fa-plus"></i>\n            </button>\n        ';const n=document.createElement("ul");n.className="category-content",this.categoryData.options.forEach((e=>{const t=document.createElement("li");t.innerText=e.PageName,t.setAttribute("data-category",e.PageName),n.appendChild(t)}));const a=document.createElement("li");a.className="no-records-message",a.style.display="none",a.innerText="No records found",n.appendChild(a),this.details.addEventListener("toggle",(t=>{const i=e.querySelector("i");i&&(i.classList.toggle("fa-angle-right"),i.classList.toggle("fa-angle-down"))})),this.details.appendChild(e),this.details.appendChild(i),this.details.appendChild(n),this.searchItemsEvent(i)}searchItemsEvent(e){const t=e.querySelector("input"),i=this.details.querySelector("ul");t.addEventListener("input",(e=>{const t=i.querySelector(".no-records-message");let n=!1;const a=e.target.value.toLowerCase().trim();Array.from(i.querySelectorAll("li:not(.no-records-message)")).forEach((e=>{var t,i;const s=(null!==(i=null===(t=e.textContent)||void 0===t?void 0:t.toLowerCase())&&void 0!==i?i:"").includes(a);e.style.display=s?"block":"none",s&&(n=!0)})),t&&(t.style.display=n?"none":"block")}))}render(e){e.appendChild(this.details)}}var $=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};class D{constructor(){this.container=document.createElement("div"),this.toolBoxService=new a,this.init(),this.getPages()}init(){return $(this,void 0,void 0,(function*(){this.container.className="tb-dropdown-menu",this.container.id="dropdownMenu",(yield this.getCategoryData()).forEach((e=>{new U(e).render(this.container)}))}))}getCategoryData(){return $(this,void 0,void 0,(function*(){return[{name:"Page",displayName:"Pages",label:"Pages",options:yield this.getPages()},{name:"Service/Product Page",displayName:"Service Pages",label:"Service Page",options:this.getServices()},{name:"Dynamic Forms",displayName:"Dynamic Forms",label:"Dynamic Forms",options:this.getDynamicForms()},{name:"Predefined Page",displayName:"Modules",label:"Modules",options:[]},{name:"Web Link",displayName:"Web Links",label:"Web Link",options:[]}]}))}getDynamicForms(){return(this.toolBoxService.forms||[]).map((e=>({PageId:e.FormId,PageName:e.ReferenceName,TileName:e.ReferenceName})))}getServices(){return(this.toolBoxService.services||[]).map((e=>({PageId:e.ProductServiceId,PageName:e.ProductServiceName,TileName:e.ProductServiceTileName||e.ProductServiceName})))}getPages(){return $(this,void 0,void 0,(function*(){var e;try{return((yield null===(e=m.AppVersions.find((e=>e.IsActive)))||void 0===e?void 0:e.Pages)||[]).filter((e=>e.PageType="Menu")).map((e=>({PageId:e.PageId,PageName:e.PageName,TileName:e.PageName})))}catch(e){throw console.error("Error fetching pages:",e),e}}))}render(e){e.appendChild(this.container)}}class G{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="sidebar-section custom-select-container",this.container.id="select-container";const e=document.createElement("div");e.className="tb-dropdown";const t=document.createElement("div");t.className="tb-dropdown-header",t.innerHTML='\n            <span id="sidebar_select_action_label">Select Action</span>\n            <i class="fa fa-angle-down"></i>\n        ';const i=new D;t.addEventListener("click",(e=>{e.preventDefault();const n=t.querySelector("i");n&&(n.classList.toggle("fa-angle-up"),n.classList.toggle("fa-angle-down"));const a=i.container;a.style.display="block"===a.style.display?"none":"block"})),e.appendChild(t),i.render(e),this.container.appendChild(e)}render(e){e.appendChild(this.container)}}class _{constructor(){this.container=document.createElement("div"),this.selectionDiv=document.createElement("div"),this.categoryOptions=document.createElement("div"),this.selectedCategory=document.createElement("span"),this.themeManager=new O,this.init()}init(){this.container.className="sidebar-section services-section",this.container.id="dropdownMenu",this.selectionDiv.className="tb-custom-category-selection";const e=document.createElement("button");e.className="category-select-button",e.setAttribute("aria-haspopup","listbox"),e.setAttribute("aria-expanded","false"),this.selectedCategory.className="selected-category-value",this.selectedCategory.textContent="General",e.appendChild(this.selectedCategory),e.onclick=t=>{t.preventDefault(),e.classList.contains("open")?this.closeSelection():(this.categoryOptions.classList.toggle("show"),e.classList.toggle("open"),e.setAttribute("aria-expanded","true"))},this.selectionDiv.appendChild(e),this.container.appendChild(this.selectionDiv),this.initializeCategoryOptions(),this.loadThemeIcons()}initializeCategoryOptions(){this.categoryOptions.className="category-options-list",this.categoryOptions.setAttribute("role","listbox"),["General","Services","Health","Living"].forEach((e=>{const t=document.createElement("div");t.className="category-option",t.role="option",t.setAttribute("data-value",e),t.textContent=e,t.onclick=()=>{this.categoryOptions.querySelectorAll(".category-option").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),this.selectedCategory.textContent=e,this.loadThemeIcons(e),this.closeSelection()},this.categoryOptions.appendChild(t)})),this.selectionDiv.appendChild(this.categoryOptions)}closeSelection(){if(this.categoryOptions.classList.contains("show")){this.categoryOptions.classList.remove("show");const e=this.container.querySelector(".category-select-button");e.setAttribute("aria-expanded","false"),e.classList.toggle("open")}}loadThemeIcons(e="General"){document.querySelectorAll("#icons-list").forEach((e=>e.remove()));const t=document.createElement("div");t.classList.add("icons-list"),t.id="icons-list",new x(this.themeManager,e).render(t),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class H extends O{constructor(){super(),this.container=document.createElement("div"),this.init()}init(){this.container.className="sidebar-section theme-section",this.container.style.paddingTop="0px";const e=this.getActiveThemeColors();new N(e,"theme-color-palette").render(this.container)}render(e){e.appendChild(this.container)}}class F{constructor(e,t,i){this.container=document.createElement("div"),this.message=e,this.title=t,this.toolboxService=new a,this.mediaId=i,this.init()}init(){this.container.classList.add("popup-modal"),this.container.style.display="flex";const e=document.createElement("div");e.classList.add("popup");const t=document.createElement("div");t.classList.add("popup-header");const i=document.createElement("span");i.innerText=this.title;const n=document.createElement("button");n.classList.add("close"),n.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 21 21">\n                <path id="Icon_material-close" data-name="Icon material-close" d="M28.5,9.615,26.385,7.5,18,15.885,9.615,7.5,7.5,9.615,15.885,18,7.5,26.385,9.615,28.5,18,20.115,26.385,28.5,28.5,26.385,20.115,18Z" transform="translate(-7.5 -7.5)" fill="#6a747f" opacity="0.54"></path>\n            </svg>\n        ',n.addEventListener("click",(()=>{this.close()})),t.appendChild(i),t.appendChild(n);const a=document.createElement("hr"),s=document.createElement("div");s.classList.add("popup-body"),s.id="confirmation_modal_message",s.innerText=this.message;const o=document.createElement("div");o.classList.add("popup-footer");const l=document.createElement("button");l.className="tb-btn tb-btn-outline",l.id="cancel_confirmation",l.innerText="Cancel",l.addEventListener("click",(()=>{this.close()}));const r=document.createElement("button");r.className="tb-btn tb-btn-primary",r.id="confirm_action",r.innerText="Confirm",r.addEventListener("click",(e=>{return t=this,i=void 0,a=function*(){e.preventDefault();try{yield this.toolboxService.deleteMedia(this.mediaId),this.toolboxService.media=this.toolboxService.media.filter((e=>e.MediaId!==this.mediaId));const e=document.getElementById(this.mediaId);e&&e.remove(),0===this.toolboxService.media.length&&(document.querySelector(".modal-actions").style.display="none"),this.close()}catch(e){console.error("Error deleting media:",e)}},new((n=void 0)||(n=Promise))((function(e,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,l)}r((a=a.apply(t,i||[])).next())}));var t,i,n,a})),o.appendChild(r),o.appendChild(l),e.appendChild(t),e.appendChild(a),e.appendChild(s),e.appendChild(o),this.container.appendChild(e)}close(){this.container.remove()}render(e){e.appendChild(this.container)}}class q{constructor(e){this.mediaFile=e,this.container=document.createElement("div"),this.init()}init(){this.container.className="file-item valid",this.container.id=this.mediaFile.MediaId;const e=document.createElement("img");e.src=this.mediaFile.MediaUrl,e.alt=this.mediaFile.MediaName,e.className="preview-image";const t=document.createElement("div");t.className="file-info";const i=document.createElement("div");i.className="file-name",i.innerText=this.mediaFile.MediaName;const n=document.createElement("div");n.className="file-size",n.innerText=this.formatBytes(this.mediaFile.MediaSize),t.appendChild(i),t.appendChild(n);const a=document.createElement("span");a.className="status-icon",a.style.color="green",this.setupItemClickEvent(a);const s=document.createElement("span");s.className="delete-media fa-regular fa-trash-can",s.title="Delete image",s.addEventListener("click",(e=>{e.stopPropagation(),this.deleteEvent()})),this.container.appendChild(e),this.container.appendChild(t),this.container.appendChild(a),this.container.appendChild(s)}formatBytes(e){const t=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Byte";const i=parseInt(Math.floor(Math.log(e)/Math.log(1024)).toString());return 0===i?e+" "+t[i]:(e/Math.pow(1024,i)).toFixed(1)+" "+t[i]}setupItemClickEvent(e){this.container.addEventListener("click",(()=>{document.querySelectorAll(".file-item").forEach((e=>{e.classList.remove("selected");const t=e.querySelector(".status-icon");t&&(t.innerHTML=e.classList.contains("invalid")?"⚠":"")})),this.container.classList.contains("selected")?e.innerHTML="":e.innerHTML='\n                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="13.423" viewBox="0 0 18 13.423">\n                        <path id="Icon_awesome-check" data-name="Icon awesome-check" d="M6.114,17.736l-5.85-5.85a.9.9,0,0,1,0-1.273L1.536,9.341a.9.9,0,0,1,1.273,0L6.75,13.282l8.441-8.441a.9.9,0,0,1,1.273,0l1.273,1.273a.9.9,0,0,1,0,1.273L7.386,17.736A.9.9,0,0,1,6.114,17.736Z" transform="translate(0 -4.577)" fill="#3a9341"></path>\n                    </svg>\n                ',this.container.classList.toggle("selected"),this.setupModalActions()}))}setupModalActions(){var e,t;const i=document.querySelector(".modal-actions");if(!i)return;i.style.display="flex";const n=i.querySelector("#cancel-modal"),a=i.querySelector("#save-modal");if(!n||!a)return;const s=n.cloneNode(!0),o=a.cloneNode(!0);null===(e=n.parentNode)||void 0===e||e.replaceChild(s,n),null===(t=a.parentNode)||void 0===t||t.replaceChild(o,a);const l=document.querySelector(".tb-modal");l&&(s.addEventListener("click",(()=>{l.style.display="none",l.remove()})),o.addEventListener("click",(()=>{this.addImageToTile(),l.style.display="none",l.remove()})))}addImageToTile(){const e=globalThis.selectedComponent;if(e)try{const t=encodeURI(this.mediaFile.MediaUrl);e.addStyle({"background-image":`url(${t})`,"background-color":"transparent","background-size":"cover","background-position":"center","background-blend-mode":"overlay"}),globalThis.tileManager.updateTile(e.parent().getId(),"BGImageUrl",t),globalThis.tileManager.updateTile(e.parent().getId(),"Opacity","0");const i=e.parent(),n=i.parent(),a=globalThis.tileManager.getTile(n.getId(),i.getId());e&&a&&new E(e,a).setTileAttributes()}catch(e){console.error("Error adding image to tile:",e)}}deleteEvent(){new F("Are you sure you want to delete this media file?","Delete media",this.mediaFile.MediaId).render(document.body)}getElement(){return this.container}render(e){e.appendChild(this.container)}}var R=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}r((n=n.apply(e,t||[])).next())}))};class z{constructor(e){this.fileListElement=null,this.progressIntervals={},this.type=e,this.modalContent=document.createElement("div"),this.toolboxService=new a,this.init()}init(){this.modalContent.className="tb-modal-content";const e=document.createElement("div");e.className="tb-modal-header";const t=document.createElement("h2");t.innerText="Upload";const i=document.createElement("span");i.className="close",i.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21">\n              <path id="Icon_material-close" data-name="Icon material-close" d="M28.5,9.615,26.385,7.5,18,15.885,9.615,7.5,7.5,9.615,15.885,18,7.5,26.385,9.615,28.5,18,20.115,26.385,28.5,28.5,26.385,20.115,18Z" transform="translate(-7.5 -7.5)" fill="#6a747f" opacity="0.54"></path>\n            </svg>\n        ',i.addEventListener("click",(e=>{e.preventDefault();const t=this.modalContent.parentElement;t.style.display="none",null==t||t.remove()})),e.appendChild(t),e.appendChild(i);const n=document.createElement("div");n.className="modal-actions";const a=document.createElement("button");a.className="tb-btn tb-btn-outline",a.id="cancel-modal",a.innerText="Cancel",a.addEventListener("click",(e=>{e.preventDefault();const t=this.modalContent.parentElement;t.style.display="none",null==t||t.remove()}));const s=document.createElement("button");s.className="tb-btn tb-btn-primary",s.id="save-modal",s.innerText="Save",n.appendChild(a),n.appendChild(s),this.modalContent.appendChild(e),this.uploadArea(),this.createFileListElement(),this.loadMediaFiles(),this.modalContent.appendChild(n)}uploadArea(){const e=document.createElement("div");e.className="upload-area",e.id="uploadArea",e.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" width="40.999" height="28.865" viewBox="0 0 40.999 28.865">\n            <path id="Path_1040" data-name="Path 1040" d="M21.924,11.025a3.459,3.459,0,0,0-3.287,3.608,3.459,3.459,0,0,0,3.287,3.608,3.459,3.459,0,0,0,3.287-3.608A3.459,3.459,0,0,0,21.924,11.025ZM36.716,21.849l-11.5,14.432-8.218-9.02L8.044,39.89h41Z" transform="translate(-8.044 -11.025)" fill="#afadad"></path>\n          </svg>\n          <div class="upload-text">\n            <p>Drag and drop or <a href="#" id="browseLink">browse</a></p>\n        </div>\n        ',this.setupDragAndDrop(e),this.modalContent.appendChild(e)}createFileListElement(){this.fileListElement=document.createElement("div"),this.fileListElement.className="file-list",this.fileListElement.id="fileList";const e=document.createElement("div");e.className="loading-media",e.textContent="Loading media files...",this.fileListElement.appendChild(e),this.modalContent.appendChild(this.fileListElement)}loadMediaFiles(){return R(this,void 0,void 0,(function*(){try{const e=yield this.toolboxService.getMediaFiles();this.fileListElement&&(this.fileListElement.innerHTML="",e&&e.length>0&&e.forEach((e=>{new q(e).render(this.fileListElement)})))}catch(e){console.error("Error loading media files:",e),this.fileListElement&&(this.fileListElement.innerHTML='<div class="error-message">Error loading media files. Please try again.</div>')}}))}setupDragAndDrop(e){return R(this,void 0,void 0,(function*(){const t=document.createElement("input");t.type="file",t.id="fileInput",t.multiple=!0,t.accept="image/jpeg, image/jpg, image/png",t.style.display="none",e.appendChild(t);const i=e.querySelector("#browseLink");null==i||i.addEventListener("click",(e=>{e.preventDefault(),t.click()})),e.addEventListener("click",(e=>{t.click()})),t.addEventListener("change",(()=>{t.files&&t.files.length>0&&this.handleFiles(t.files)})),e.addEventListener("dragover",(t=>{t.preventDefault(),e.classList.add("drag-over")})),e.addEventListener("dragleave",(t=>{t.preventDefault(),e.classList.remove("drag-over")})),e.addEventListener("drop",(t=>R(this,void 0,void 0,(function*(){var i;t.preventDefault(),e.classList.remove("drag-over"),(null===(i=t.dataTransfer)||void 0===i?void 0:i.files)&&t.dataTransfer.files.length>0&&(yield this.handleFiles(t.dataTransfer.files))}))))}))}handleFiles(e){return R(this,void 0,void 0,(function*(){const t=Array.from(e);for(const e of t)if(e.type.startsWith("image/"))try{const t=yield this.readFileAsDataURL(e),i=e.name.replace(/\s+/g,"-").replace(/[()]/g,""),n={MediaId:Date.now().toString(),MediaName:i,MediaUrl:t,MediaType:e.type,MediaSize:e.size};if(this.fileListElement&&this.displayMediaFileProgress(this.fileListElement,n),!this.validateFile(n))return;(yield this.toolboxService.uploadFile(n.MediaUrl,n.MediaName,n.MediaSize,n.MediaType)).BC_Trn_Media}catch(t){if(console.error("Error processing file:",t),this.fileListElement){const i=document.createElement("div");i.className="upload-error",i.textContent=`Error uploading ${e.name}: ${t}`,this.fileListElement.insertBefore(i,this.fileListElement.firstChild),setTimeout((()=>{i.remove()}),5e3)}}}))}displayMediaFileProgress(e,t){const i=document.createElement("div");i.className="file-item "+(this.validateFile(t)?"valid":"invalid"),i.setAttribute("data-mediaid",t.MediaId);const n=this.validateFile(t);var a;i.innerHTML=`\n              <img src="${t.MediaUrl}" alt="File thumbnail" class="preview-image">\n              <div class="file-info">\n                <div class="file-info-details">\n                  <div>\n                    <div class="file-name">${a=t.MediaName,a.split("-").slice(1).join("-")}</div>\n                    <div class="file-size">${this.formatFileSize(t.MediaSize.toString())}</div>\n                  </div>\n                  <div class="progress-text">0%</div>\n                </div>\n                <div class="progress-bar">\n                    <div class="progress" style="width: 0%"></div>\n                </div>\n                ${n?"":"<small>File is invalid. Please upload a valid file (jpg, png, jpeg and less than 2MB).</small>"}\n              </div>\n              <span class="status-icon" style="color: ${n?"green":"red"}">\n                ${n?"":"⚠"}\n              </span>\n              ${n?"":'<span style="margin-left: 10px" id="delete-invalid" class="fa-regular fa-trash-can"></span>'}\n            `,e.insertBefore(i,e.firstChild);const s=i.querySelector("#delete-invalid");s&&(s.style.cursor="pointer",s.addEventListener("click",(t=>{t.preventDefault(),e.removeChild(i)})));let o=0;const l=i.querySelector(".progress"),r=i.querySelector(".progress-text"),c=setInterval((()=>{o+=Math.floor(15*Math.random())+5,l&&(l.style.width=`${o>100?100:o}%`),r&&(r.textContent=`${o>100?100:o}%`),o>=100&&(clearInterval(c),n&&(e.removeChild(i),this.displayMediaFile(e,t)))}),300);this.progressIntervals=this.progressIntervals||{},this.progressIntervals[t.MediaId]=c}validateFile(e){const t=e.MediaSize<=2097152,i=["image/jpeg","image/jpg","image/png"].includes(e.MediaType);return t&&i}formatFileSize(e){const t=parseInt(e,10);return t<1024?t+" B":t<1048576?Math.round(t/1024)+" KB":(t/1048576).toFixed(2)+" MB"}displayMediaFile(e,t){const i=new q(t);i.render(e),e.insertBefore(i.getElement(),e.firstChild)}destroy(){Object.values(this.progressIntervals).forEach((e=>{clearInterval(e)})),this.progressIntervals={}}readFileAsDataURL(e){return new Promise(((t,i)=>{const n=new FileReader;n.onload=()=>{n.result?t(n.result):i(new Error("FileReader did not produce a result"))},n.onerror=()=>{i(n.error)},n.readAsDataURL(e)}))}render(e){e.appendChild(this.modalContent)}}class V{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="bg-section";const e=document.createElement("button");e.className="add-image",e.id="image-bg",e.innerHTML='\n            <span class="plus">\n               <i class="fa fa-plus"></i>\n            </span>\n            <span class="image-icon">\n                <i class="fa fa-image"></i>\n            </span>\n        ';const t=document.createElement("div");t.className="slider-wrapper",t.id="slider-wrapper",t.style.display="none";const i=document.createElement("input");i.type="range",i.id="bg-opacity",i.min="0",i.max="100",i.value="80",i.addEventListener("input",(e=>{const t=e.target.value,i=document.getElementById("valueDisplay");i&&(i.innerHTML=`${t}%`),this.updateImageOpacity(t)}));const n=document.createElement("span");n.id="valueDisplay",n.innerHTML="80%",t.appendChild(i),t.appendChild(n),e.addEventListener("click",(e=>{if(e.preventDefault(),!globalThis.selectedComponent)return;const t=document.createElement("div");t.classList.add("tb-modal"),t.style.display="flex",new z("tile").render(t);const i=document.createElement("input");i.type="file",i.multiple=!0,i.accept="image/jpeg, image/jpg, image/png",i.id="fileInput",i.style.display="none",document.body.appendChild(t),document.body.appendChild(i)})),this.container.appendChild(e),this.container.appendChild(t)}updateImageOpacity(e){globalThis.selectedComponent}render(e){e.appendChild(this.container)}}class J{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("tile-img-container"),this.container.id="tile-img-container";const e=document.createElement("img");e.alt="Tile Image",e.src="https://staging.comforta.yukon.software/media/receptie-197@3x.png",e.className="tile-img-thumbnail";const t=document.createElement("button");t.className="tile-img-delete-button",t.id="tile-img-delete-button",t.innerHTML='<i class="fa fa-xmark"></i>',this.container.appendChild(e),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class W{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("tile-img-section");const e=new J;(new V).render(this.container),e.render(this.container)}render(e){e.appendChild(this.container)}}class Z{constructor(){this.input=document.createElement("input"),this.init()}init(){this.input.type="text",this.input.placeholder="Enter a title",this.input.classList.add("tb-form-control"),this.input.id="tile-title",this.input.addEventListener("input",(e=>{const t=globalThis.selectedComponent;if(!t)return;const i=t.closest(".container-row").components().length,n=t.find(".tile-title")[0];if(n){const e=3===i?this.truncate(11):2===i?this.truncate(14):this.truncate(25);n.components(e)}globalThis.tileManager.updateTile(t.parent().getId(),"Text",this.input.value.trim())}))}truncate(e){return this.input.value.length>e?this.input.value.substring(0,e)+"..":this.input.value}render(e){e.appendChild(this.input)}}class K{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="text-color-palette text-colors",this.container.id="text-color-palette",Object.entries({color1:"#ffffff",color2:"#333333"}).forEach((([e,t])=>{const i=document.createElement("div");i.className="color-item";const n=document.createElement("input");n.type="radio",n.id=`text-color-${e}`,n.name="text-color",n.value=t;const a=document.createElement("label");a.className="color-box",a.setAttribute("for",`text-color-${e}`),a.style.backgroundColor=t,a.setAttribute("data-tile-color",t),i.appendChild(n),i.appendChild(a),this.container.appendChild(i),a.onclick=e=>{e.preventDefault();const i=globalThis.selectedComponent;i&&(i.addStyle({color:t}),globalThis.tileManager.updateTile(i.parent().getId(),"Color",t),n.checked=!0)}}))}render(e){e.appendChild(this.container)}}class Q{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("text-alignment");const e=document.createElement("div");e.classList.add("align-item"),e.innerHTML='\n            <input type="radio" id="tile-left"\n                name="alignment" value="left" />\n            <label for="tile-left" class="fas fa-align-left">\n            </label>\n        ';const t=document.createElement("div");t.classList.add("align-item"),t.innerHTML='\n            <input type="radio" id="tile-center"\n                     name="alignment" value="center" />\n            <label for="tile-center">\n                <svg xmlns="http://www.w3.org/2000/svg"\n                width="12.7" height="14.626"\n                viewBox="0 0 12.7 14.626">\n                <path id="Group_2344-converted"\n                    data-name="Group 2344-converted"\n                    d="M5.863,1.868V3.736L5.031,2.9,4.2,2.073l-.336.341-.336.342,1.411,1.41L6.35,5.577,7.758,4.17,9.165,2.762l-.333-.333L8.5,2.1l-.831.817-.83.817V0H5.863V1.868M0,7.313v.794H12.7V6.519H0v.794m4.937,3.149-1.4,1.4.333.333.334.333.83-.816.831-.817v3.729h.974V10.89l.832.832.831.832.336-.342.336-.341L7.766,10.465c-.773-.773-1.41-1.406-1.416-1.406s-.642.631-1.413,1.4"\n                    fill-rule="evenodd" fill="#696969" />\n                </svg>\n            </label>\n        ',e.onclick=e=>{e.preventDefault();const t=document.getElementById("tile-left"),i=globalThis.selectedComponent;if(!i)return;i.addStyle({"justify-content":"start","align-items":"start"});const n=i.find(".tile-title")[0];n&&n.addStyle({"text-align":"left"}),globalThis.tileManager.updateTile(i.parent().getId(),"Align","left"),t.checked=!0},t.onclick=e=>{e.preventDefault();const t=document.getElementById("tile-center"),i=globalThis.selectedComponent;if(!i)return;i.addStyle({"justify-content":"center","align-items":"center"});const n=i.find(".tile-title")[0];n&&n.addStyle({"text-align":"center"}),globalThis.tileManager.updateTile(i.parent().getId(),"Align","center"),t.checked=!0},this.container.appendChild(e),this.container.appendChild(t)}render(e){e.appendChild(this.container)}}class X{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.classList.add("title-style");const e=new K,t=new Q;e.render(this.container),t.render(this.container)}render(e){e.appendChild(this.container)}}class Y{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="sidebar-section title-section";const e=new Z,t=new X;e.render(this.container),t.render(this.container)}render(e){e.appendChild(this.container)}}class ee{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.id="menu-page-section";const e=new H,t=new W,i=new Y,n=new G,a=new _;e.render(this.container),t.render(this.container),i.render(this.container),n.render(this.container),a.render(this.container)}render(e){e.appendChild(this.container)}}class te{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="tb-tab-content active-tab",this.container.id="pages-content",(new ee).render(this.container)}render(e){e.appendChild(this.container)}}class ie{constructor(e){this.templateList=document.createElement("div"),this.templateList.id="page-templates",e.forEach(((e,t)=>{const i=document.createElement("div");i.className="page-template-wrapper";const n=document.createElement("div");n.className="page-template-block-number";const a=document.createElement("div");a.className="page-template-block",a.title="Click to select template";const s=document.createElement("div"),o=document.createElement("img");o.style.width="100%",o.style.height="100%",o.src=e.image,s.appendChild(o),a.appendChild(s),n.innerHTML=`${t+1}`,i.appendChild(n),i.appendChild(a),this.templateList.appendChild(i)}))}render(e){e.appendChild(this.templateList)}}class ne{constructor(){this.container=document.createElement("div"),this.init()}init(){this.container.className="tb-tab-content active-tab",this.container.id="templates-content",this.container.style.display="none";const e=document.createElement("div");e.className="sidebar-section",e.id="page-templates",new ie([{image:"/Resources/UCGrapes1/src/images/template-1.png"},{image:"/Resources/UCGrapes1/src/images/template-2.png"},{image:"/Resources/UCGrapes1/src/images/template-3.png"},{image:"/Resources/UCGrapes1/src/images/template-4.png"}]).render(e),this.container.appendChild(e)}render(e){e.appendChild(this.container)}}class ae{constructor(){this.container=document.getElementById("tools-section"),this.init()}init(){const e=new k,t=new te,i=new ne;e.render(this.container),t.render(this.container),i.render(this.container)}render(e){e.appendChild(this.container)}}class se{constructor(){}setUpNavBar(){const e=document.getElementById("tb-navbar");document.getElementById("navbar_title").textContent="App toolbox",(new B).render(e)}setUpSideBar(){const e=document.getElementById("tb-sidebar");(new ae).render(e)}setUpScrollButtons(){const e=document.getElementById("child-container"),t=document.querySelector(".navigator .page-navigator-left"),i=document.querySelector(".navigator .page-navigator-right"),n=()=>{t.style.display=e.scrollLeft>0?"none":"block";const n=e.scrollWidth-e.clientWidth;i.style.display=e.scrollLeft<n-5?"none":"block"};t.onclick=()=>{e.scrollLeft-=300},i.onclick=()=>{e.scrollLeft+=300},e.addEventListener("scroll",n),window.addEventListener("resize",n),n()}}const oe=class{constructor(){this.config=e.getInstance(),this.toolboxManager=new se,this.editor=new S,this.config.isInitialized||console.error("ToolboxApp created before AppConfig was initialized!"),this.initialise()}initialise(){this.toolboxManager.setUpNavBar(),this.toolboxManager.setUpSideBar(),this.editor.init()}};window.App=class{constructor(t,i,n,a,s,o){e.getInstance().init(t,i,n,a,s,o),this.toolboxApp=new oe}}})();